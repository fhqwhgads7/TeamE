<!DOCTYPE html>
<html>
	<head>
		<script src="../js/jquery.js"></script>
		<script src="../js/shared.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/shared.css"></link>
		<script>
			var unsavedChanges = false;
			
			function Initialize(){
				GlobalInitialize();
				LoadOptions();
			}
			function SaveChanges(){
				localStorage.setItem("BGMVolume", $("#BGMVolumeNum").text());
				localStorage.setItem("SFXVolume", $("#SFXVolumeNum").text());
				unsavedChanges = false;
			}
			function GoToMenu(Unsaved){
				if (!Unsaved){
					playSound(GameSounds.ButtonSelect);
					SwitchToPage("title.html");
				}
				else
					ShowUnsavedDialog();
			}
			function LoadOptions(){
				var BGMVolume = parseInt(localStorage.getItem("BGMVolume"));
				if (!BGMVolume)
					BGMVolume = 50;
				var SFXVolume = parseInt(localStorage.getItem("SFXVolume"));
				if (!SFXVolume)
					SFXVolume = 50;
					
				dialSet("BGMDial", BGMVolume);
				ChangeVolume("BGMVolumeNum", BGMVolume);
				dialSet("SFXDial", SFXVolume);
				ChangeVolume("SFXVolumeNum", SFXVolume);
				
				//$("#BGM_MainMenu").val(localStorage.getItem("BGM_MainMenu"));
				//$("#BGM_InGame").val(localStorage.getItem("BGM_InGame"));
				//$("#BGM_TimeRunningOut").val(localStorage.getItem("BGM_TimeRunningOut"));
				//$("#BGM_FinalScores").val(localStorage.getItem("BGM_FinalScores"));
			}
			function dialSet(id, value){
				$("#"+id).val(value);
			}
			function ChangeVolume(id, value){
				if ($("#"+id).text() != value)
					unsavedChanges = true;
				$("#"+id).text(value);
			}
			function ShowSaveChangesDialog(){
				$("#PopupOverlay").show();
				$("#SaveChangesDialog").show();
				playSound(GameSounds.Message);
			}
			function HideSaveChangesDialog(){
				$("#PopupOverlay").hide();
				$("#SaveChangesDialog").hide();
			}
			function ShowResetOptionsDialog(){
				$("#PopupOverlay").show();
				$("#ResetOptionsDialog").show();
				playSound(GameSounds.Message);
			}
			function HideResetOptionsDialog(){
				$("#PopupOverlay").hide();
				$("#ResetOptionsDialog").hide();
			}
			function ShowUnsavedDialog(){
				$("#PopupOverlay").show();
				$("#UnsavedDialog").show();
				playSound(GameSounds.Message);
			}
			function HideUnsavedDialog(){
				$("#PopupOverlay").hide();
				$("#UnsavedDialog").hide();
			}
		</script>
		<style>
			div.OptionsBox{
				position:absolute;
				border-style:solid;
				border-width:5px;
				width:60%;
				height:30%;
				box-shadow: 0px 0px 40px 5px #AAAAAA;
				background-color:rgba(0,0,0,.2);
			}
			div.OptionsBox:hover{
				background-color:rgba(255,255,255,.1);
			}
			.Options{
				position:absolute;
				right:3%;
				width:28%;
				font-family:"Arial";
				font-size:15px;
				font-weight:900;
			}
			.roundSlider{
				position:absolute;
				width:100px;
			}
		</style>
	</head>
	<body onload="Initialize()">
		<div id="MainBackground">
		<div id="ContentContainer">
			<div class="OptionsBox" id="OptionsBox" style="left:20%;top:35%;">
				<div class="StandardText" style="font-size:30px;left:3%;top:18%;">BGM Volume</div>
				<div class="StandardText" style="font-size:30px;left:3%;top:55%;">SFX Volume</div>
				
				<input type="range" min=0 max=100 value=50 id="BGMDial" step=1 style="position:absolute;left:60%;top:20%;" onchange="ChangeVolume('BGMVolumeNum',value);"></input>
				<input type="range" min=0 max=100 value=50 id="SFXDial" step=1 style="position:absolute;left:60%;top:62%;" onchange="ChangeVolume('SFXVolumeNum',value); SFXVolume=value;"></input>
				<div class="StandardText" style="font-size:20px;right:40%;top:20%;text-align:right"id="BGMVolumeNum">50</div>
				<div class="StandardText" style="font-size:20px;right:40%;top:62%;text-align:right"id="SFXVolumeNum">50</div>				
				
			</div>
			<div class="StandardText" id="MainTitle" style="font-size:45px;margin:0px;width:100%;top:20%;">Audio Settings</div>
			<button class="Standard" onclick="SaveChanges(); ShowSaveChangesDialog(); LoadOptions(); noSound();" style="width:20%;left:20%;top:72%;font-size:14px;">Save Changes</button>
			<button class="Standard" onclick="LoadOptions(); ShowResetOptionsDialog(); noSound();" style="width:20%;left:40.5%;top:72%;font-size:14px;">Reset Options</button>
			<button class="Standard" onclick="GoToMenu(unsavedChanges); noSound();" style="width:20%;left:61%;top:72%;font-size:14px;">Main Menu</button>
			
			<div class="PopupOverlay" id="PopupOverlay">
				<div class="Popup" id="SaveChangesDialog" style="top:35%;height:30%;width:60%;left:20%">
					<div class="StandardText" style="font-size:20px;margin:0px;width:100%;top:30%;">Your new changes have been saved.</div>
					<button class="Standard" onclick="HideSaveChangesDialog()" style="font-size:14px;left:30%;top:70%;width:40%">OK</button>
				</div>
				<div class="Popup" id="ResetOptionsDialog" style="top:35%;height:30%;width:60%;left:20%">
					<div class="StandardText" style="font-size:20px;margin:0px;width:100%;top:30%;">Your previous settings have been restored.</div>
					<button class="Standard" onclick="HideResetOptionsDialog()" style="font-size:14px;left:30%;top:70%;width:40%">OK</button>
				</div>
				<div class="Popup" id="UnsavedDialog" style="top:35%;height:30%;width:60%;left:20%">
					<div class="StandardText" style="font-size:20px;margin:0px;width:100%;top:25%;">You have unsaved changes. Do you want to save them?</div>
					<button class="Standard" onclick="HideUnsavedDialog(); SaveChanges();" style="font-size:14px;left:2.5%;top:70%;width:30%">Yes</button>
					<button class="Standard" onclick="HideUnsavedDialog(); GoToMenu(false);" style="font-size:14px;left:35%;top:70%;width:30%">No</button>
					<button class="Standard" onclick="HideUnsavedDialog()" style="font-size:14px;left:67.5%;top:70%;width:30%">Cancel</button>
				</div>
			</div>
		</div>
		</div>
	</body>
</html>