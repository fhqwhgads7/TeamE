<!DOCTYPE html>
<html>
	<head>
		<!--
		You have to go up one level in order to access files from other folders.
		.. = One folder up from the current folder.
		-->
		<script src="../js/jquery.js"></script>
		<script src="../js/shared.js"></script>
		<script src="../js/primary_gameboard_operation.js"></script>
		<script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/shared.css"></link>
		<script type="text/javascript">

			var RotateDir=0;
			var Rotation=0;
			
			function Initialize()
			{
				//The commented code does not function properly yet.
				//When something screws up during runtime, other functions just stop.
				//So I had to comment them out to allow the game board to rotate, which it does.
				GlobalInitialize(true);
				GameInitialize();
				//var Game=JSON.parse(localStorage.MainGame);
				//alert(Game.Name);
				setInterval("RotateThink();",50);
				pickATip();
			}
			function RotateBegin(dir){
				RotateDir=dir*5;
			}
			function RotateEnd(){
				RotateDir=0;
			}
			function RotateThink(){
				if(RotateDir!=0){
					Rotation+=RotateDir;
					RotateDir%=360;
					//if((RotateDir>=360)||(RotateDir<=-360)){RotateDir=0;}
					document.getElementById("GameBoardCircle").style.webkitTransform="rotate("+Rotation.toString()+"deg)";
					document.getElementById("GameBoardCircle").style.MozTransform="rotate("+Rotation.toString()+"deg)";
					var Prods=document.getElementsByClassName("ProductDisplayItem");
					if(Prods.length>0){
						for(Key in Prods){
							if(Prods[Key].style){
								Prods[Key].style.webkitTransform="rotate("+(-Rotation).toString()+"deg)";
								Prods[Key].style.MozTransform="rotate("+(-Rotation).toString()+"deg)";
							}
						}
					}
				}
			}
			function pickATip()
			{
				document.getElementById("GameAdvice").innerHTML = 
				theTips[ Math.floor( Math.random() * theTips.length ) ];
			}
			function displayNewProductDialog() {
				$("#PopupOverlay").show();
				$("#new-product-dialog").show();		
			}
			function hideNewProductDialog() {
				$("#new-product-dialog").hide();
				$("#PopupOverlay").hide();
			}
			function displayEmployeeDialog() {
				UpdateEmpPopupDisplays();
				$("#PopupOverlay").show();
				$("#employee-dialog").show();
			}
			function hideEmployeeDialog() {
				$("#employee-dialog").hide();
				$("#PopupOverlay").hide();
			}
			function UpdateEmpPopupDisplays(){
				var ply=TheGame.CurrentPlayer;
				$("#EmpPopupDev").html(ply.NumDevs.toString());
				$("#EmpPopupDes").html(ply.NumCreative.toString());
				$("#EmpPopupTes").html(ply.NumQA.toString());
			}
			function ShowAllPlayers(){
				$("#PopupOverlay").show();
				PopulateScoreboard();
				$("#Scoreboard").show();
			}
			function HideScoreboard(){
				$("#Scoreboard").hide();
				$("#PopupOverlay").hide();
			}
			function EndCurrentTurn(){
				CycleTurn();
			}
			function TryToQuitGame(){
				$("#PopupOverlay").show();
				$("#QuitDialog").show();
			}
			function QuitGame(saveFirst){
				if(saveFirst){
					alert("get your filthy hands off that");
					return;
				}else{
					CloseQuitDialog();
					TheGame=null;
					localStorage.setItem("TheBrandNewGame",null);
					SwitchToPage("title.html");
				}
			}
			function CloseQuitDialog(){
				$("#QuitDialog").hide();
				$("#PopupOverlay").hide();
			}
		</script>
		<style>
			#GameBoardCircle
			{
				background-image:url('../images/gameboard_circle.png');
				position:absolute;
				top:0%;
				left:24%;
				width:600px;
				height:600px;
				webkit-transform-origin:50% 50%;
				moz-transform-origin:50% 50%;
			}
			#GameBoardCenter
			{
				background-image:url('../images/gameboard_center.png');
				position:absolute;
				top:0%;
				left:24%;
				width:800px;
				height:600px;
			}
			#ProductWindow{
				position:absolute;
				top:35%;
				left:3%;
				width:19%;
				height:40%;
				border-style:solid;
				border-width:8px;
				border-color:gray;
				background-color:rgba(0,0,0,.8);
			}
			#CashAlert{
				font-family:arial;
				font-size:30px;
				font-weight:400;
				position:absolute;
				top:9%;
				left:20%;
				color:red;
				text-shadow:-1px -1px 2px #FFFFFF,1px 1px 1px #000000,3px 3px 5px #000000;
				transition:top 2.2s ease-in,left 2.2s ease-in,opacity 2s ease-in;
				visibility:hidden;
			}
			div.PlayerBox{
				position:absolute;
				border-style:solid;
				border-width:7px;
				width:30%;
				height:15%;
				/*box-shadow: 0px 0px 40px 5px #AAAAAA;*/
				background:rgba(0,0,0,.75);
				-moz-border-radius:10px;
				-webkit-border-radius:10px;
				border-radius:10px;
			}
			div.PlayerBox:hover{
				background:rgba(30,30,30,.75);
			}
			marquee#GameAdvice{
				position:absolute;
				bottom:3%;
				height:0px;
				font-family: calibri, verdana, arial, sans-serif; 
				font-size: 15pt; 
				color: #CCCCCC;
				cursor: hand;
			}
		</style>
	</head>
	<body onload="Initialize()">
		<div id="MainBackground">
			<div id="ContentContainer">
				<div id="MainBoard" style="top:0%;left:0%">
					
				<marquee id="GameAdvice" scrollamount="20" onmouseover="this.scrollAmount=0;" onmouseout="this.scrollAmount=20;">
				</marquee>
				
					<div class="PlayerBox" id="CurPlyBox" style="border-color:grey;width:25%;left:2%;top:4%;">
						<div class="StandardText" id="CurPlyName" style="font-size:25px;left:10%;top:5%;">nil</div>
						<div class="StandardText" style="font-size:18px;left:10%;top:35%;color:rgb(160,160,160)">$<span id="CurPlyMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
						<div class="StandardText" style="font-size:10px;left:12%;top:62%;color:rgb(160,160,160);font-size:10px">Products <span id="CurPlyProds" style="color:white">nil</span></div>
						<div class="StandardText" style="font-size:10px;left:54%;top:62%;color:rgb(160,160,160);font-size:10px">Developers <span id="CurPlyDevs" style="color:white">nil</span></div>
						<div class="StandardText" style="font-size:10px;left:12%;top:77%;color:rgb(160,160,160);font-size:10px">Designers <span id="CurPlyDsgns" style="color:white">nil</span></div>
						<div class="StandardText" style="font-size:10px;left:54%;top:77%;color:rgb(160,160,160);font-size:10px">Testers <span id="CurPlyTsts" style="color:white">nil</span></div>
					</div>

					<div id="GameBoard">
						<div id="GameBoardCenter"></div>
						<div id="GameBoardCircle"></div>
						<button class="Standard Compact" id="TurnBoardCCWButton" style="top:24%;left:4%;width:2%;height:7%;padding:.2em 1.6em" onmousedown="RotateBegin(-1)" onmouseup="RotateEnd()" onmouseout="RotateEnd()"><b><</b></button>
						<button class="Standard Compact" id="TurnBoardCWButton" style="top:24%;left:19%;width:2%;height:7%;padding:.2em 1.6em" onmousedown="RotateBegin(1)" onmouseup="RotateEnd()" onmouseout="RotateEnd()"><b>></b></button>
					</div>
					<div id="ProductWindow" class="PlayerBox" style="overflow:hidden;display:none">
						<div class="StandardText" style="left:10%;top:2%;color:white;font-size:14px;text-align:center"><span id="ProdDisplayName">nil</span><sup style="font-size:10px;color:rgb(120,120,120)">&reg;</sup></div>
						<div class="StandardText" style="left:10%;top:14%;font-size:11px;text-align:left"><span style="color:rgb(120,120,120)">By </span><span id="ProdOwnerDisplayName">nil</span><sup style="color:rgb(120,120,120)">&trade;</sup></div>
						<div class="StandardText" style="left:6%;top:27%;font-size:10px"><span style="color:rgb(120,120,120)">Category </span><span id="DisplayCAT">0</span></div>
						<div class="StandardText" style="left:6%;top:34%;font-size:8px"><span style="color:rgb(120,120,120)">Subcategory </span><span id="DisplaySUBCAT">0</span></div>
						<div class="StandardText" style="left:6%;top:39%;font-size:10px"><span style="color:rgb(120,120,120)">Idea Strength </span><span id="DisplayPIS">0</span></div>
						<div class="StandardText" style="left:6%;top:45%;font-size:10px"><span style="color:rgb(120,120,120)">Design Strength </span><span id="DisplayPDS">0</span></div>
						<div class="StandardText" style="left:6%;top:51%;font-size:10px"><span style="color:rgb(120,120,120)">Build Strength </span><span id="DisplayPBS">0</span></div>
						<div class="StandardText" style="text-overflow:hidden;left:6%;top:58%;font-size:8px"><span style="color:rgb(120,120,120)">Phase </span><span id="DisplayPPhase">nil</span></div>
						<div class="StandardText" style="left:6%;top:63%;font-size:10px"><span style="color:rgb(120,120,120)">PFID </span><span id="DisplayPFID">0</span></div>
						<button class="Standard Compact" id="CurProdAdvanceButton" style="top:82%;left:6%;height:15%;width:42%;" onclick="TryToAdvanceProduct();" disabled>Progress</button>
						<button class="Standard Compact" id="CurProdRevertButton" style="top:82%;left:52%;height:15%;width:42%;" onclick="TryToRevertProduct();" disabled>Regress</button>
						<button class="Standard Compact" id="CurProdPatentButton" style="top:66%;left:52%;height:15%;width:42%;visibility:hidden" onclick="TryToPatentProduct();" disabled>Patent</button>
					</div>
					<button id="new-product-button" class="Standard Compact" style="top:80%;left:3%;width:10%;height:8%;"onclick="displayNewProductDialog()">New<br>Product</button>
					<button id="employee_button" class="Standard Compact" style="top:80%;left:13%;width:11%;height:8%;" onclick="displayEmployeeDialog()">Manage<br>Employees</button>
					<button class="Standard Compact" style="top:88%;left:3%;width:10%;height:8%;" onclick="ShowAllPlayers()">Show Players</button>
					<button class="Standard Compact" style="top:88%;left:13%;width:11%;height:8%;" onclick="EndCurrentTurn()">End Turn</button>
					
					<button class="Standard Compact" style="bottom:4%;left:90%;width:8%;height:5%;" onclick="TryToQuitGame()">Quit</button>

					<div class="PopupOverlay" id="PopupOverlay">
						<div class="Popup" id="new-product-dialog">
							<div class="StandardText" style="margin:0px;width:100%;top:10%">New Product</div>
							<textarea id="NewProdName" maxlength=25 placeholder="New Product Name" style="position:absolute;resize:none;top:35%;left:19.5%;width:60%"></textarea>
							<div class="StandardText" style="left:20%;top:53%;font-size:12px">Category</div>
							<select class="OneColumn" id="NewProductCategory" style="top:53%;left:40%;width:40%;" onchange="SelectProductCategory()">
								<!-- dynamic -->
							</select>
							<div class="StandardText" style="left:20%;top:60%;font-size:12px">Subcategory</div>
							<select class="OneColumn" id="NewProductSubCategory" style="top:60%;left:40%;width:40%;">
								<!-- dynamic -->
							</select>
							<button class="Standard" style="left:10%;top:75%" onclick="hideNewProductDialog()">Cancel</button>
							<button class="Standard" style="left:51%;top:75%" onclick="createNewProduct()">Create</button>
						</div>
						<div class="Popup" id="employee-dialog">
							<div class="StandardText" style="margin:0px;width:100%;top:5%">Manage Employees</div>
							<div class="StandardText" style="top:22%;left:14.5%;width:10%;font-size:12px">Designers</div>
							<button class="Standard" style="top:27%;left:10%;width:10%" onclick="EmployeeChange('des',1)"><b>+</b></button>
							<div class="StandardText" style="top:44%;left:18%" id="EmpPopupDes">0</div>
							<button class="Standard" style="top:57%;left:10%;width:10%" onclick="EmployeeChange('des',-1)"><b>-</b></button>
						
							<div class="StandardText" style="top:22%;left:43.25%;font-size:12px">Developers</div>
							<button class="Standard" style="top:27%;left:40%;width:10%" onclick="EmployeeChange('dev',1)"><b>+</b></button>
							<div class="StandardText" style="top:44%;left:48%" id="EmpPopupDev">0</div>
							<button class="Standard" style="top:57%;left:40%;width:10%" onclick="EmployeeChange('dev',-1)"><b>-</b></button>
							
							<div class="StandardText" style="top:22%;left:75.75%;font-size:12px">Testers</div>
							<button class="Standard" style="top:27%;left:70%;width:10%" onclick="EmployeeChange('tes',1)"><b>+</b></button>
							<div class="StandardText" style="top:44%;left:78%" id="EmpPopupTes">0</div>
							<button class="Standard" style="top:57%;left:70%;width:10%" onclick="EmployeeChange('tes',-1)"><b>-</b></button>
							
							<button class="Standard" style="top:80%;left:10%;width:80%" onclick="hideEmployeeDialog()">Done</button>
						</div>
						<div class="Popup" id="Scoreboard" style="left:10%;top:10%;width:80%;height:80%">
							<div class="StandardText" id="ScoreboardTitle" style="left:10%;top:5%;width:80%;height:80%">Scoreboard</div>
							<div class="PlayerBox" id="PlyOneScbdBox" style="display:none;border-color:red;left:13%;top:19%;">
								<div class="StandardText" id="PlyOneScbdName" style="left:14%;top:5%;font-size:16px">nil</div>
								<div class="StandardText" style="left:14%;top:35%;color:rgb(120,120,120);font-size:14px">$<span id="PlyOneScbdMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
								<div class="StandardText" style="left:14%;top:70%;color:rgb(120,120,120);font-size:10px">Products <span id="PlyOneScbdProds" style="color:white">nil</span></div>
								<div class="StandardText" style="left:55%;top:70%;color:rgb(120,120,120);font-size:10px">Employees <span id="PlyOneScbdEmps" style="color:white">nil</span></div>
							</div>
							<div class="PlayerBox" id="PlyTwoScbdBox" style="display:none;border-color:red;left:55%;top:19%;">
								<div class="StandardText" id="PlyTwoScbdName" style="left:14%;top:5%;font-size:16px">nil</div>
								<div class="StandardText" style="left:14%;top:35%;color:rgb(120,120,120);font-size:14px">$<span id="PlyTwoScbdMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
								<div class="StandardText" style="left:14%;top:70%;color:rgb(120,120,120);font-size:10px">Products <span id="PlyTwoScbdProds" style="color:white">nil</span></div>
								<div class="StandardText" style="left:55%;top:70%;color:rgb(120,120,120);font-size:10px">Employees <span id="PlyTwoScbdEmps" style="color:white">nil</span></div>
							</div>
							<div class="PlayerBox" id="PlyThreeScbdBox" style="display:none;border-color:red;left:13%;top:41%;">
								<div class="StandardText" id="PlyThreeScbdName" style="left:14%;top:5%;font-size:16px">nil</div>
								<div class="StandardText" style="left:14%;top:35%;color:rgb(120,120,120);font-size:14px">$<span id="PlyThreeScbdMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
								<div class="StandardText" style="left:14%;top:70%;color:rgb(120,120,120);font-size:10px">Products <span id="PlyThreeScbdProds" style="color:white">nil</span></div>
								<div class="StandardText" style="left:55%;top:70%;color:rgb(120,120,120);font-size:10px">Employees <span id="PlyThreeScbdEmps" style="color:white">nil</span></div>
							</div>
							<div class="PlayerBox" id="PlyFourScbdBox" style="display:none;border-color:red;left:55%;top:41%;">
								<div class="StandardText" id="PlyFourScbdName" style="left:14%;top:5%;font-size:16px">nil</div>
								<div class="StandardText" style="left:14%;top:35%;color:rgb(120,120,120);font-size:14px">$<span id="PlyFourScbdMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
								<div class="StandardText" style="left:14%;top:70%;color:rgb(120,120,120);font-size:10px">Products <span id="PlyFourScbdProds" style="color:white">nil</span></div>
								<div class="StandardText" style="left:55%;top:70%;color:rgb(120,120,120);font-size:10px">Employees <span id="PlyFourScbdEmps" style="color:white">nil</span></div>
							</div>
							<div class="PlayerBox" id="PlyFiveScbdBox" style="display:none;border-color:red;left:13%;top:63%;">
								<div class="StandardText" id="PlyFiveScbdName" style="left:14%;top:5%;font-size:16px">nil</div>
								<div class="StandardText" style="left:14%;top:35%;color:rgb(120,120,120);font-size:14px">$<span id="PlyFiveScbdMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
								<div class="StandardText" style="left:14%;top:70%;color:rgb(120,120,120);font-size:10px">Products <span id="PlyFiveScbdProds" style="color:white">nil</span></div>
								<div class="StandardText" style="left:55%;top:70%;color:rgb(120,120,120);font-size:10px">Employees <span id="PlyFiveScbdEmps" style="color:white">nil</span></div>
							</div>
							<div class="PlayerBox" id="PlySixScbdBox" style="display:none;border-color:red;left:55%;top:63%;">
								<div class="StandardText" id="PlySixScbdName" style="left:14%;top:5%;font-size:16px">nil</div>
								<div class="StandardText" style="left:14%;top:35%;color:rgb(120,120,120);font-size:14px">$<span id="PlySixScbdMoney" style="color:white">nil</span><sup style="font-size:10px">.00</sup></div>
								<div class="StandardText" style="left:14%;top:70%;color:rgb(120,120,120);font-size:10px">Products <span id="PlySixScbdProds" style="color:white">nil</span></div>
								<div class="StandardText" style="left:55%;top:70%;color:rgb(120,120,120);font-size:10px">Employees <span id="PlySixScbdEmps" style="color:white">nil</span></div>
							</div>
							<button class="Standard" id="ScoreboardClose" onclick="HideScoreboard()" style="top:87%;left:10%;width:80%;height:10%">Done</button>
						</div>
						<div class="Popup" id="QuitDialog">
							<div class="StandardText" style="margin:0px;width:100%;top:10%">Are You Sure?</div>
							<button class="Standard" style="left:14%;top:35%;width:72%" onclick="QuitGame(true)">Save and Quit</button>
							<button class="Standard" style="left:14%;top:55%;width:72%" onclick="QuitGame(false)">Quit Without Saving</button>
							<button class="Standard" style="left:14%;top:75%;width:72%" onclick="CloseQuitDialog()">Cancel</button>
						</div>
					</div>
					<span id="CashAlert">0</span>
				</div>
			</div>
			<div id="RoundAnnouncer">ROUND<br>1</div>
		</div>	
	</body>
</html>